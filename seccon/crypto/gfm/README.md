problem.sage を読むと、 `FLAG` の値を一つ一つ 行列 `MS` に埋め込んでいるのがわかります。
`enc = key * MS * key` は全て行列積なので、 `MS = key^(-1) * enc * key^(-1)` とやれば `MS` を復元できます。

注意すべきなのは、 `MS` の要素は全て `p` を法とする剰余環になっているので、計算結果は `p` で mod を取る必要があります。

SageMathの環境を用意してあげると、逆行列の計算が容易になります。
